<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</title>
<link rel="stylesheet" href="style.css">
<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: #f5f5f5;
}

/* Header —Å –±–æ–ª—å—à–∏–º –ø–æ–∏—Å–∫–æ–º */
header {
    background: #ff8c00;
    padding: 20px;
    text-align: center;
    position: relative;
}
header h1 { margin: 0; color: white; }

.big-search {
    margin-top: 20px;
}
.big-search input {
    width: 500px;
    padding: 12px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 16px;
}
.big-search button {
    padding: 12px 16px;
    background: #fff;
    border: none;
    border-radius: 6px;
    cursor: pointer;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Å–Ω–æ–≤–Ω–æ–π */
.main-container {
    display: flex;
    margin: 30px auto;
    width: 90%;
}

/* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å */
.left-panel {
    width: 250px;
    margin-right: 20px;
    background: #fff;
    border-radius: 10px;
    padding: 15px;
    transition: transform 0.3s ease;
    transform: translateX(0);
    box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    position: relative;
    z-index: 2;
}
.left-panel.hidden {
    transform: translateX(-260px);
}

.burger-btn {
    display: block;
    font-size: 30px;
    margin-bottom: 20px;
    cursor: pointer;
}

.left-panel input {
    width: 100%;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #aaa;
}

.sort-select {
    margin-top: 10px;
    width: 100%;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #aaa;
}

/* –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ */
.results {
    flex: 1;
}

.card {
    background: white;
    margin-bottom: 15px;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.card a {
    text-decoration: none;
    color: #ff8c00;
    font-weight: bold;
}
.price {
    color: #ff8c00;
    font-weight: bold;
    font-size: 18px;
}

/* –ê–¥–∞–ø—Ç–∏–≤ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
@media (max-width: 800px) {
    .main-container { flex-direction: column; }
    .left-panel { width: 100%; margin-bottom: 20px; transform: translateX(-100%); position: absolute; top: 0; left: 0; height: 100%; z-index: 10; }
    .left-panel.visible { transform: translateX(0); }
    .results { width: 100%; }
}
</style>
</head>
<body>

<header>
    <h1>–ü–æ–∏—Å–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏—Ö</h1>
    <div class="big-search">
        <input id="bigSearch" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞...">
        <button id="bigSearchBtn">üîç</button>
    </div>
</header>

<div class="main-container">
    <div class="left-panel" id="leftPanel">
        <span class="burger-btn" id="burgerBtn">‚ò∞</span>
        <input id="sideSearch" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...">
        <select id="sortSelect" class="sort-select">
            <option value="none">–ë–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</option>
            <option value="price-asc">–¶–µ–Ω–∞: –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
            <option value="price-desc">–¶–µ–Ω–∞: –ø–æ —É–±—ã–≤–∞–Ω–∏—é</option>
            <option value="alphabet">–ü–æ –∞–ª—Ñ–∞–≤–∏—Ç—É</option>
        </select>
    </div>

    <div class="results" id="results"></div>
</div>

<script>
let products = [];

// –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
async function loadData() {
    const res = await fetch('data.json'); 
    products = await res.json();

    const params = new URLSearchParams(window.location.search);
    const query = params.get('q') || '';

    document.getElementById('bigSearch').value = query;
    document.getElementById('sideSearch').value = query;

    filterAndRender(query);
}

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Ä–µ–Ω–¥–µ—Ä
function filterAndRender(q) {
    const query = q.toLowerCase();
    let filtered = products.filter(p => 
        p.name.toLowerCase().includes(query) ||
        p.keywords.some(k => k.toLowerCase().includes(query))
    );
    applySort(filtered);
}

function render(list) {
    const container = document.getElementById('results');
    container.innerHTML = '';
    if(!list.length){
        container.innerHTML = "<p>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>";
        return;
    }
    list.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <div>
                <strong>${item.name}</strong><br>
                –ú–∞–≥–∞–∑–∏–Ω: ${item.store}<br>
                <a href="${item.link}" target="_blank">–ü–µ—Ä–µ–π—Ç–∏</a>
            </div>
            <div class="price">${item.price.toLocaleString()} ‚ÇΩ</div>
        `;
        container.appendChild(card);
    });
}

// –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
function applySort(list){
    const mode = document.getElementById('sortSelect').value;
    if(mode === 'price-asc') list.sort((a,b)=>a.price-b.price);
    if(mode === 'price-desc') list.sort((a,b)=>b.price-a.price);
    if(mode === 'alphabet') list.sort((a,b)=>a.name.localeCompare(b.name));
    render(list);
}

// –ü–æ–∏—Å–∫
document.getElementById('bigSearchBtn').addEventListener('click', () => {
    const val = document.getElementById('bigSearch').value.trim();
    if(val) window.location.href = `search.html?q=${encodeURIComponent(val)}`;
});

document.getElementById('sideSearch').addEventListener('input', (e)=>{
    filterAndRender(e.target.value);
});

document.getElementById('sortSelect').addEventListener('change', ()=>{
    filterAndRender(document.getElementById('sideSearch').value);
});

// –ë—É—Ä–≥–µ—Ä-–º–µ–Ω—é
const burgerBtn = document.getElementById('burgerBtn');
const leftPanel = document.getElementById('leftPanel');

burgerBtn.addEventListener('click', () => {
    if(leftPanel.classList.contains('hidden') || leftPanel.classList.contains('visible')){
        leftPanel.classList.toggle('visible');
        leftPanel.classList.remove('hidden');
    } else {
        leftPanel.classList.add('hidden');
    }
});

loadData();
</script>
</body>
</html>
